# tree-shaking-bundle-diet

1. 번들 사이즈를 줄여야 하는 이유에 대해서 생각해보자

- 웹 페이지 로딩 속도와 이탈률
- 같은 용량의 이미지 파일과 js 파일의 차이?

2. 번들 사이즈를 줄이는 방법은?

- 라이브러리 중복 줄이기

우리가 a,b 라이브러리를 사용하고 a,b 라이브러리가 c 라이브러리를 참조할 경우 패키지 매니저는 a,b,c를 모두 설치해야됨

만약 a 라이브러리가 c 라이브러리의 3.3.1 버전을 참조하고 b 라이브러리가 c 라이브러리의 3.3.2 버전을 참조하는 경우
(즉 여러 라이브러리가 같은 라이브러리의 서로 다른 버전을 참조하는 경우가 있음)
이런 경우를 Dependency conflict 라고 함

패키지 매니저마다 이런 문제를 다양한 방법으로 해결

-> 더 높은 버전을 사용
-> 사용자에게 어느 버전을 설치할지 확인받는 방식

- npm의 경우 트리구조로 필요한 버전을 모두 설치 받는 방식

한 라이브러리에 디펜던시가 있다면 그 라이브러리 아래에 또 node_modules 폴더를 만들어서
그곳에 디펜던시의 디펜던시를 저장함
그리고 노드 런타임에 상황에 맞게 부모의 node_modules를 가져갈지 자식의 node_modules를 가져갈지 적합한 폴더를 설치해줌

-> 서로 다른 두 버전이라 할지라도 모두 번들되어 요청에 따라 각각 다른 버전의 라이브러리를 사용할 수 있음

npm을 사용하면 디펜던시를 더 편하게 관리하고 작성자가 의도한 버전대로 동작하는 효과를 얻을 수 있음
그러나 중복된 라이브러리가 쌓이게 되고 번들 사이즈가 커져 tree 구조로 라이브러리를 계속 저장하면
node_modules도 과도한 용량을 차지하게 된다.

node_modules가 과도하게 커지는 문제를 해결하게 위해 npm은 라이브러리들이 semver을 지킨다고 가정
semver을 준수하면 메이저 버전이 바뀌지 않는한 더 높은 버전을 사용해도 문제가 없으니 둘 중 더 높은 버전만 받아 중복 라이브러리를 줄이고 있음
-> 이 기능이 항상 동작하는 것은 아님
//https://velog.io/@real-bird/Node-npm-%ED%8C%A8%ED%82%A4%EC%A7%80-%EB%A7%A4%EB%8B%88%EC%A0%80

npm에서는 중복된 모듈을 줄일 수 있는 기능을 제공 (npm dedupe)
dedupe를 활용하면 중복된 라이브러리의 버전을 확인하고 적합한 버전으로 통합할 수 있음(중복된 디펜던시 삭제)

tree shaking
불필요한 코드를 정적분석을 통해 제거하는 기술
